<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="utf-8" />
    <title>Book Catalog</title>
</head>
<body>
<div th:if="${#authentication.authenticated}">
    Hello, <b th:text="${#authentication.name}"></b>
</div>
<h2>Book Catalog</h2>

<form action="/books" method="get">
    <label for="category">Category:</label>
    <select id="category" name="categoryId">
        <option value="" th:text="'All Categories'">All Categories</option>
        <th:block th:each="cat : ${categories}">
            <option th:value="${cat.id}"
                    th:text="${cat.name}"
                    th:selected="${cat.id} == ${selectedCategory}"></option>
        </th:block>
    </select>

    <label for="q">Search:</label>
    <input id="q" name="q" type="text" th:value="${q}" placeholder="Title or author" />

    <button type="submit">Filter</button>
</form>

<hr />

<div th:if="${#lists.isEmpty(books)}">
    <p>No books found.</p>
</div>

<ul>
    <li th:each="book : ${books}">
        <h3 th:text="${book.title} + ' — ' + ${book.author}"></h3>
        <p>Price: <span th:text="${book.price}"></span></p>
        <p th:text="${book.description}"></p>
        <p>Category: <span th:text="${book.category != null ? book.category.name : '—'}"></span></p>
        <button>Add to cart</button>
        <hr />
    </li>
</ul>

<p><a href="/">Back to home</a></p>

</body>
</html>